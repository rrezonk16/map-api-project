import { useLocation } from "react-router-dom";
import React, { useState, useEffect } from "react";
import axios from "axios";
import currencies from "./currencies.png";
import AnimatedNumber from "./AnimatedNumber";
import MyMap from "./myMap";
import wiki from "../Data/wiki.png";
export const Country = () => {
  const [country, setCountry] = useState([]);

  const location = useLocation();
  const searchParams = new URLSearchParams(location.search);
  const countryCode = searchParams.get("code");

  useEffect(() => {
    fetchData();

    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [countryCode]);

  const fetchData = async () => {
    try {
      const response = await axios.get(
        `https://restcountries.com/v3.1/alpha/${countryCode}`
      );
      setCountry(response.data);
      console.log(response);
    } catch (error) {
      console.error("Error fetching data:", error);
    }
  };

  const countryData = country[0] || {}; // Ensure country is not undefined

  if (!countryData.name) {
    return <div>Loading...</div>;
  }

  console.log(countryData.capitalInfo.latlng);
  const lat = countryData.capitalInfo.latlng[0];
  const long = countryData.capitalInfo.latlng[1];

  const linkUrl = `https://en.wikipedia.org/wiki/${countryData.name.common}`;

  return (
    <div className="container">
      <div className=" text-3xl flex justify-between align-middle py-8">
        <div className="flex flex-row gap-3 items-center ">
          <a href="/countries">
            <svg
              className="w-10"
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
              fill="#fff"
              transform="rotate(270)"
            >
              <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
              <g
                id="SVGRepo_tracerCarrier"
                stroke-linecap="round"
                stroke-linejoin="round"
              ></g>
              <g id="SVGRepo_iconCarrier">
                <path d="M20.946 15.076L14 9.84V5.19a4.6 4.6 0 0 0-2-4.183 4.6 4.6 0 0 0-2 4.183v4.648l-6.946 5.237S2 15.895 2 16.714v1.046l7.994-3.142.802 4.73c-2.13 2.171-2.808 2.255-2.808 2.633V23L12 22.008l4.012.992v-1.019c0-.379-.678-.462-2.808-2.633l.802-4.73L22 17.76v-1.046c0-.819-1.054-1.638-1.054-1.638zm-7.723-1.84l-1.094 6.447.358.364a24.83 24.83 0 0 0 1.502 1.422L12 20.978l-1.989.49c.4-.344.894-.8 1.502-1.421l.358-.364-1.094-6.448-7.406 2.911a2.541 2.541 0 0 1 .3-.28l7.326-5.53V5.19A4.081 4.081 0 0 1 12 2.288a4.081 4.081 0 0 1 1.003 2.902v5.146l7.337 5.537a2.718 2.718 0 0 1 .292.274z"></path>
                <path fill="none" d="M0 0h24v24H0z"></path>
              </g>
            </svg>
          </a>
          <span>{countryData.name.common || "Country Details"}</span>
        </div>
        <div className="flex flex-row gap-5 text-xl items-center	 ">
          <a href={linkUrl} target="_blank" rel="noopener noreferrer">
            Read More
          </a>{" "}
          <img src={wiki} alt="wikipedia" className="w-10" />
        </div>
      </div>
      <div className="grid lg:grid-cols-6 grid-cols-2 mb-12  gap-4">
        <div className="lg:col-span-2 col-span-3  border-personal p-8 rounded-3xl ">
          <div className="flex flex-col gap-5">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="60"
              height="75"
              viewBox="0 0 60 75"
              fill="none"
            >
              <path
                d="M51 39C55.9706 39 60 43.0294 60 48V51C60 62.8287 48.8429 75 30 75C11.1571 75 0 62.8287 0 51V48C0 43.0294 4.02944 39 9 39H51ZM30 0C39.1127 0 46.5 7.3873 46.5 16.5C46.5 25.6127 39.1127 33 30 33C20.8873 33 13.5 25.6127 13.5 16.5C13.5 7.3873 20.8873 0 30 0Z"
                fill="white"
              />
            </svg>
            <span className="text-3xl mt-2">
              <AnimatedNumber startValue={countryData.population} />
            </span>
          </div>
        </div>
        <div className="col-span-3 border-personal  p-8 rounded-3xl  ">
          <div className="flex flex-col  gap-5 items-baseline align-bottom">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="60"
              height="49"
              viewBox="0 0 60 49"
              fill="none"
            >
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M35.625 0V16.7906H28.125V9.29062H24.375V7.41562H16.875V9.29062H13.125V14.9156H7.6875V3.66562H0V48.6656H1.875V30.8531H3.65625V34.6031H9.375V48.75H11.25V26.1656H15.7725V22.4156H20.0381V26.1656H24.375V24.2906H21.9131V20.5406H13.8975V24.2906H9.375V32.7281H5.53125V28.9781H1.875V5.54062H5.8125V16.7906H15V11.1656H18.75V9.29062H22.5V11.1656H26.25V18.6656H37.5V1.875H45V20.5406H52.5V7.41562H58.125V28.0406H53.4375V24.2906H45V26.1656H51.5625V29.9156H58.125V48.6656H60V5.54062H50.625V18.6656H46.875V0H35.625ZM31.9181 20.5369C31.8868 20.5366 31.8555 20.5378 31.8244 20.5406C31.6063 20.5511 31.3988 20.6373 31.2375 20.7844L19.0537 32.0344C18.9135 32.1618 18.8152 32.3288 18.7718 32.5133C18.7283 32.6977 18.7418 32.891 18.8104 33.0676C18.8791 33.2443 18.9996 33.396 19.1562 33.5027C19.3128 33.6095 19.498 33.6663 19.6875 33.6656H20.625V47.7244C20.625 47.973 20.7238 48.2115 20.8996 48.3873C21.0754 48.5631 21.3139 48.6619 21.5625 48.6619H42.1875C42.4361 48.6619 42.6746 48.5631 42.8504 48.3873C43.0262 48.2115 43.125 47.973 43.125 47.7244V33.6656H44.0625C44.2523 33.667 44.4381 33.6108 44.5953 33.5043C44.7524 33.3979 44.8736 33.2462 44.9426 33.0694C45.0117 32.8926 45.0255 32.699 44.9822 32.5142C44.9389 32.3294 44.8405 32.162 44.7 32.0344L43.125 30.5831V25.2394C43.1265 25.114 43.1029 24.9897 43.0555 24.8736C43.0081 24.7576 42.938 24.6522 42.8492 24.5638C42.7604 24.4753 42.6547 24.4056 42.5385 24.3587C42.4223 24.3117 42.2978 24.2886 42.1725 24.2906C41.9245 24.2946 41.6882 24.3966 41.5153 24.5745C41.3424 24.7523 41.247 24.9914 41.25 25.2394V28.8506L32.5125 20.7863C32.3501 20.6355 32.1395 20.5471 31.9181 20.5369ZM31.875 22.7569L41.6625 31.7906H22.0875L31.875 22.7569ZM22.5 34.0688H41.25V46.7869H35.625V40.2244C35.625 39.9757 35.5262 39.7373 35.3504 39.5615C35.1746 39.3856 34.9361 39.2869 34.6875 39.2869H29.0625C28.8139 39.2869 28.5754 39.3856 28.3996 39.5615C28.2238 39.7373 28.125 39.9757 28.125 40.2244V46.7869H22.5V34.0688ZM30 41.1619H33.75V46.7869H30V41.1619Z"
                fill="white"
              />
            </svg>
            <span className="text-3xl">
              {countryData.capital} <br />
              {countryData.name.official}
            </span>
          </div>
        </div>{" "}
        <div className="lg:col-span-1 col-span-2  border-personal  p-4 rounded-3xl items-center flex justify-center ">
          <img
            src={countryData.coatOfArms?.svg}
            className=" h-36"
            alt="Coat of Arms"
          />
        </div>
        <div className="border-personal lg:col-span-1 col-span-1 p-6 rounded-3xl flex flex-col gap-4 text-3xl">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="60"
            height="60"
            viewBox="0 0 60 60"
            fill="none"
          >
            <path
              d="M30 0C13.4444 0 0 13.4444 0 30C0 46.5556 13.4444 60 30 60C46.5556 60 60 46.5556 60 30C60 13.4444 46.5556 0 30 0ZM30 2.22222C34.2556 2.22222 38.2667 3.20222 41.8711 4.90889C39.2689 5.43333 37.0578 6.57556 36.5289 6.45778C35.7178 6.28 31.7889 6.96 30.3467 7.5C28.9044 8.04222 29.04 8.72889 28.68 8.82C28.32 8.90889 28.1267 9.23111 27.5689 9.86C27.0111 10.4911 27.8467 11.2489 27.8467 11.2489C27.8467 11.2489 29.9867 11.7311 30.3467 10.1378C30.56 9.19333 30.2578 10.9467 30.3467 11.6667C30.4356 12.3889 31.78 12.5667 32.5 11.6667C32.8244 11.26 32.78 10.2667 32.9867 9.93111C33.24 9.51778 33.8 9.83333 34.0978 9.79111C34.2756 9.76889 33.8667 10.0733 34.0978 10.2089C34.5578 10.48 35.5044 10.0156 35.2778 11.1111C35.1867 11.5533 33.7911 11.64 33.6111 12.2911C33.4289 12.9422 33.1244 13.3333 33.1244 13.3333L30.14 13.4022L29.1667 12.0133C29.1667 12.0133 28.22 12.4244 28.4711 13.2644C28.6467 13.8422 28.1956 14.5133 28.1956 14.5133C28.1956 14.5133 26.6667 14.7578 26.6667 15.2089C26.6667 15.4556 26.0444 15.4867 25.6933 15.6244C25.4067 15.7378 25.2133 16.2089 24.9311 16.2489C24.7622 16.2711 23.7067 16.4267 23.4733 16.4578C22.8378 16.5356 23.1244 16.68 23.1244 16.9444C23.1244 17.3044 24.3044 17.3622 24.3044 17.3622C24.3044 17.3622 25.06 17.6533 24.7933 18.1933C24.5222 18.7356 24.9844 18.9578 24.4444 18.9578C24.2089 18.9578 23.6667 18.8844 23.1244 18.8889C22.4244 18.8889 21.7533 18.6689 21.7356 18.9578C21.6689 20.0689 21.6667 21.6667 21.6667 21.6667C21.6667 21.6667 22.6156 22.1333 23.1244 22.0133C23.8311 21.8489 24.8667 22.4022 25.3467 21.1111C25.3844 21.0111 25.4089 20.7956 25.4867 20.6933C25.82 20.2556 26.1822 19.3711 26.7356 19.0978C27.0756 18.9267 27.5489 19.0378 27.7089 19.0289C28.0689 19.0067 28.68 18.54 28.68 18.54C28.68 18.54 30.2756 18.7578 30.6933 20.3467C30.8178 20.8156 30.7 21.5867 30.9711 21.7356C31.1378 21.8267 31.8756 21.0422 31.8756 21.0422L32.7089 21.1111L32.2222 20L30.6933 18.2644L30.9711 18.1311C30.9711 18.1311 32.1311 18.2067 32.2222 18.4756C32.3111 18.7467 33.7067 19.4311 33.4733 20.2133C33.0822 21.5044 34.0289 21.8089 34.0289 21.8089C34.0289 21.8089 34.8489 22.0022 35.2067 21.3244C35.52 20.7311 35.5556 20.2133 35.5556 20.2133L36.5978 20C36.5978 20 36.4978 17.8378 37.6378 17.7778C38.78 17.72 38.8889 17.7778 38.8889 17.7778C38.8889 17.7778 41.3956 18.6067 41.6667 19.2356C41.9356 19.8667 42.06 20.4667 41.2489 20.5556C40.44 20.6467 39.2356 20.4889 39.2356 20.4889C39.2356 20.4889 36.0489 20.0067 36.32 20.9067C36.5889 21.8089 36.8756 22.7133 36.8756 22.7133C36.8756 22.7133 37.5667 22.64 38.1933 22.7778C38.8644 22.9311 39.7222 22.8467 39.7222 22.8467L39.8622 24.3756L39.4444 24.5133C38.9911 24.64 37.6511 24.7267 37.2911 24.86C36.9311 24.9933 33.0067 24.3089 32.9178 24.4444C32.8267 24.5778 31.5533 25.04 30.8333 24.8622C30.1133 24.68 29.9311 22.9867 29.9311 22.9867C29.9311 22.9867 29.8 22.1778 29.3067 22.2222L25.4178 22.5689C25.4178 22.5689 24.3067 23.0644 24.3067 23.3333C24.3067 23.3333 23.9911 23.1067 23.5422 23.3333C23.0911 23.56 22.4022 23.5289 22.2222 23.8889C22.0422 24.2489 21.3333 24.9244 20.9711 25.5556C20.6133 26.1844 19.5778 26.2356 19.3044 27.3622C19.0356 28.4867 18.8444 30.3689 18.8889 31.18C18.9333 31.9911 18.9111 34.0022 19.7222 34.4444C20.5333 34.8889 21.6089 35.9822 22.0133 36.3889C22.4178 36.7933 24.5911 37.1222 24.86 36.9444C25.1311 36.7644 26.1022 36.3889 26.5978 36.3889C27.0933 36.3889 28.1578 36.4667 28.4733 36.7356C28.7867 37.0067 29.1733 37.5889 29.4444 38.2644C29.7133 38.94 29.9844 40.08 30.2089 40.4867C30.4333 40.8911 31.2889 41.6644 30.9711 42.4311C30.6578 43.1978 30.1178 43.96 30.2089 44.86C30.2978 45.76 30.8378 46.9556 31.0422 47.36C31.2467 47.7644 32.5467 49.0378 32.5 49.4444C32.4556 49.8489 32.8378 49.7489 33.3333 49.9311C33.8289 50.1089 35.9333 49.5289 36.2511 49.1667C36.5644 48.8067 37.0533 47.6689 37.64 47.0822C38.2244 46.4978 39.44 45.5378 40.0689 44.86C40.7 44.1844 41.3444 43.5644 41.3889 42.7089C41.4333 41.8511 40.9378 39.9689 41.3889 39.6533C41.84 39.3378 42.4644 38.8489 42.9178 38.2644C43.3667 37.6778 44.3244 37.7244 45 35.8333C45.6756 33.9422 45.8978 33.3533 45.7644 33.2644C45.6311 33.1733 44.5556 33.62 44.3756 33.8889C44.1956 34.16 43.1422 34.2267 42.9156 34.4444C42.6933 34.6622 41.6667 34.4444 41.6667 34.4444C41.6667 34.4444 42.1 32.7378 41.8756 32.1533C41.6489 31.5689 40.4978 29.2822 40.1378 28.4711C39.8422 27.8067 39.7911 27.0378 39.9311 26.5289C39.9889 26.6111 40.0244 26.6556 40.0689 26.7356C40.2289 27.0244 41.0933 28.0467 41.4578 29.0978C42.2356 31.3489 43.1244 32.9867 43.1244 32.9867C43.1244 32.9867 44.2978 33.0311 46.2511 31.5267C47.5778 30.5067 48.9978 30.4533 49.2356 29.9311C49.6867 28.94 47.8467 28.0556 47.8467 28.0556H46.18L44.9311 25.9022L45.2778 25.7644C45.2778 25.7644 46.6622 27.3622 47.2911 27.3622C47.9222 27.3622 49.5978 27.2156 50.14 27.8467C50.68 28.4778 52.3689 29.5444 52.64 30.6244C52.9111 31.7044 52.7733 33.2156 53.2622 33.7511C53.9556 34.5022 54.5844 34.4444 54.5844 34.4444L55.4178 32.5L57.3622 30.2778L57.7733 30.0689C57.7356 45.3911 45.3289 57.7778 30 57.7778C23.0198 57.7807 16.2967 55.1436 11.18 50.3956L12.0133 49.1667L12.9867 45.2778L10.6244 43.82L7.91778 42.9156L6.11111 38.5422C6.11111 38.5422 4.42667 37.18 3.02889 36.5489C2.50087 34.4057 2.23007 32.2073 2.22222 30C2.22222 28.3622 2.39333 26.7644 2.66667 25.2044C4.37333 23.8933 6.66667 22.8489 6.66667 22.8489C6.66667 22.8489 7.93333 22.7022 5.76444 19.0978C5.48859 18.6446 5.28046 18.1534 5.14667 17.64C6.05778 15.8089 7.14444 14.0822 8.42 12.5067C8.30889 13.1667 7.87778 15.9067 8.68 16.3889C9.58 16.9289 10.4444 15.2622 10.6244 14.7222C10.8044 14.1822 12.6822 12.1222 13.4022 11.0422C13.9156 10.2711 13.7356 8.77556 13.2067 7.9C18.0288 4.21422 23.9305 2.21887 30 2.22222ZM24.5133 7.22222C24.0822 7.26444 23.1933 7.49556 23.1933 8.19556V9.51333C23.1933 9.51333 22.9267 9.98889 22.7778 10.14C22.6267 10.2889 22.7578 10.98 22.8467 11.2511C22.9356 11.5222 22.9867 12.3622 22.9867 12.3622C22.9867 12.3622 23.4222 12.5889 23.5422 12.7089C23.6622 12.8267 24.6889 13.0867 25.14 12.8467C25.5889 12.6089 25.8511 11.9756 26.18 11.9444C26.5111 11.9133 26.3089 11.9156 26.2489 11.6667C26.1911 11.4267 26.5289 10.5556 26.5289 10.5556L25.6244 9.79111C25.6244 9.79111 25.0778 8.62444 25.1378 8.26444C25.1978 7.90222 24.6933 7.26444 24.7222 7.22222C24.7289 7.2 24.6556 7.2 24.5133 7.22222ZM22.1556 9.86222C22.0333 9.91556 21.7978 10.2089 21.6689 10.2778C21.4978 10.3644 21.5511 10.6622 21.46 10.9022C21.3711 11.1422 21.1133 12.0133 21.1133 12.0133L21.6689 12.2222C21.6689 12.2222 22.5511 12.0556 22.6422 11.8756C22.7133 11.7311 22.4533 10.9422 22.3622 10.6244C22.34 10.5489 22.3622 10.4867 22.3622 10.4867L22.2244 9.93111C22.2022 9.88667 22.1956 9.84222 22.1556 9.86V9.86222ZM45.42 17.5C45.6222 17.5 46.0222 17.6422 46.1133 17.7089C46.2333 17.7978 46.2333 18.8533 46.1133 19.5133C46.0691 19.734 46.0997 19.963 46.2004 20.1643C46.301 20.3655 46.4659 20.5275 46.6689 20.6244C46.8511 20.6844 46.9778 22.1311 46.9467 22.4311C46.9178 22.7311 46.0689 22.9556 45.8356 22.9867C45.6022 23.0178 44.6244 23.0089 44.6556 22.5689C44.6867 22.1333 44.4867 20.7089 44.3067 20.1378C44.1289 19.5689 44.1756 18.76 44.4467 18.6111C44.7178 18.4622 45.28 17.5689 45.28 17.5689C45.3022 17.52 45.3511 17.5022 45.42 17.5ZM44.1689 42.0844C44.06 42.0844 43.9022 42.1067 43.7511 42.1511C43.7511 42.1511 43.6889 43.4844 43.0578 43.8889C42.4289 44.2956 42.0156 45.08 42.0156 45.4867C42.0156 45.8911 41.8822 46.26 42.0156 46.6667C42.1511 47.0711 42.46 47.4067 42.8489 47.3622C43.24 47.3178 43.6622 46.4733 43.7533 46.1111C43.8422 45.7511 44.1778 44.9733 44.4467 44.7222C44.7178 44.4711 44.7711 43.7644 44.7244 43.4022C44.6867 43.0889 44.9244 42.0667 44.1689 42.0844Z"
              fill="white"
            />
          </svg>
          {countryData.region}
        </div>
        <div className="row-span-2 col-span-3 border-personal  p-8 rounded-3xl  ">
          <img src={countryData.flags?.svg} className="w-full " alt="Flag" />
        </div>
        <div className="border-personal  p-6 rounded-3xl lg:col-span-2 col-span-3 row-span-2 justify-center">
          <MyMap lat={lat} long={long} />

          <br />
        </div>
        <div className="border-personal  p-6 rounded-3xl flex flex-col gap-4 lg:col-span-1 col-span-3">
          <img src={currencies} alt="money" className=" w-16" />

          {countryData.currencies &&
            Object.keys(countryData.currencies).map(
              (currencyCode, currencyIndex) => (
                <div key={currencyIndex}>
                  {countryData.currencies[currencyCode].name}{" "}
                  {countryData.currencies[currencyCode].symbol}
                </div>
              )
            )}
        </div>
      </div>
    </div>
  );
};
